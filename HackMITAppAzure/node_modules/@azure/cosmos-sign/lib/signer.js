"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const type = "master";
const version = "1.0";
function Signer(hmac) {
    function signature(masterKey, method, resourceType = "", resourceId = "", date = new Date()) {
        var text = method.toLowerCase() +
            "\n" +
            resourceType.toLowerCase() +
            "\n" +
            resourceId +
            "\n" +
            date.toUTCString().toLowerCase() +
            "\n" +
            "" +
            "\n";
        const signature = hmac(masterKey, text);
        return encodeURIComponent("type=" + type + "&ver=" + version + "&sig=" + signature);
    }
    function headers(masterKey, method, resourceType = "", resourceId = "", date = new Date()) {
        const sig = signature(masterKey, method, resourceType, resourceId, date);
        return {
            Authorization: sig,
            "x-ms-date": date.toUTCString()
        };
    }
    return {
        headers,
        signature
    };
}
exports.Signer = Signer;
